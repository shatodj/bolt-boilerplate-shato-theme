

{# Theme Section block #}
{# Required: section, bgColor #}
{# Optional: isParalax #}
{% block section %}

	{% if section.image is not empty %}
		{% set bgImages = section.image|thumbnail('index-small') ~ ';' ~ section.image|image  %}
	{% endif %}

	<div class="shpr-lazy-background" {% if section.image is not empty %} data-background-image="{{ bgImages|default() }}" {% endif %}>
			
			{# Adding empty elements to handle dynamic background styling - see lazy-section-backgorund.js #}
			{% if isParalax|default == true and section.image is not empty %}
				<div class="shpr-background shpr-background-paralax"></div>
			{% endif %}	
			<div class="shpr-background shpr-background-overlay"></div>

			{# Actual section with content #}
			<section class="section is-medium shpr-section is-section-{{ bgColor }}">
				<div class="shpr-section-anchor" id="{{ section.slug }}"></div>
				<div class="container has-text-centered">
					{% with { blk: section }%}
					{{ block('content_block') }}
					{%- endwith -%}	
				</div>
			</section>
		</div>

{% endblock %}

{# Content block #}
{# Showing content of 'block' content type#}
{% block content_block %}
	<h2 class="title is-3 is-spaced {{ title_class|default('') }}">{{ blk.title }}</h2>

	{%- if blk.content is not empty %}
		<div class="content">
			{{ blk.content }}
		</div>
	{% endif -%}

	{# Embedded #}
	{%- if blk.embedded is not empty %}
		{{ blk.embedded.html|raw }}
	{% endif %}
	{%- if blk.embedded_raw is not empty %}
		{{ blk.embedded_raw|raw }}
	{% endif %}

	{# Showing the listing of contents  #}
	{# If 'contenttemplate' is not present then will be generated by the type of data' #}
	{%- if blk.contentlink is not empty %}
		{% setcontent subBlockContent = blk.contentlink %}

		{# Generate template name in case is contenttemplate is not defined #}
		{% if blk.contenttemplate|default() is not empty %}
			{% set template = blk.contenttemplate %}
		{% else %}
			{% set templateName = subBlockContent is iterable ? 'listing' : 'content' %}
			{% set template = 'twig/contentblock/' ~ templateName ~ '.twig' %}
		{% endif %}
		
		<section>
			{% include template with { content: subBlockContent } %}
		</section>
	{% endif -%}

	{# showing the gallery if added to the block #}
	{% if blk.gallery|length %}
		<section class="content">
			<div class="shpr-gallery imagelist">
				{% import "twig/partials/_macros.twig" as m %}
				{{ m.lazyGallery(blk.gallery, "160", "120") }}
			</div>
		</section>
	{% endif %}

	{# Showing links / actions for the Block #}
	{% if blk.links|length > 0 %}
		<nav class="shpr-actions columns">
			<div class="column has-text-centered">
			{% for link in blk.links %}	
				<a href="{{ link.contentlink }}" class="button">{{ link.title|raw }}</a>			
			{% endfor %}
			</div>
		</nav>
	{% endif %}
	
{% endblock %}
