{% extends 'partials/_master.twig' %}
{% import "partials/_macros.twig" as m %}

{% set headerBlockClass = 'hero is-medium is-primary is-header shpr-lazy-background' %}

{% block stylesheet %}
    {# Defer loading of non-critical styles #}
    {{ m.stylesheet('dist/css/record-bundle.css') }}
{% endblock %}

{% block scripts %}
    {{ m.script('dist/js/record-bundle.js') }}
{% endblock %}


{% block content %}
	{% if record is defined %}
        <article>
            {# create progressive image loading list delimited by ; so smallest image is loaded first #}
            {% set bgImages = record.image|default() is not empty ? record.image|thumbnail('index-small') ~ ';' ~ record.image|image : ''  %}
            
            {% block header_block %}
                <header class="{{ headerBlockClass }}" data-background-image="{{ bgImages|default() }}">
                    <div class="shpr-background shpr-background-overlay"></div>
                    <div class="hero-body">
                        <div class="container has-text-centered">
                            {% block header %}
                                <h1 class="title is-3 is-spaced">{{ record.title }}</h1>
                                <p class="subtitle is-5">{{ record.datepublish|date('d.m.Y') }}</p>
                                {% include 'partials/_record_meta.twig' with {'extended': false} %}
                            {% endblock %}
                        </div>
                    </div>
                </header>
            {% endblock %}

            {% block body %}
                <section class="section">
                    <div class="container content">
                        {# Output all fields, in the order as defined in the contenttype.
                        To change the generated html and configure the options, see:
                        https://docs.bolt.cm/templating #}
                        {% with { 'record': record, 'extended': true, 'repeaters': true, 'blocks': true } %}
                        {{ block('sub_fields', 'partials/_sub_fields.twig') }}
                        {% endwith %}

                        {% block record_footer %}
                            {{ include('partials/_recordfooter.twig', { 'record': record, 'extended': true }) }}
                        {% endblock %}
                    </div>
                </section>
            {% endblock %}
        </article>
	{% endif %}

	{# Standard SECTIONS #}
	{% block sections %}
		{{ m.section("record") }}
	{% endblock %}

    {# {% block recent %}
	    {% include "partials/_sub_recent_records.twig" %} 
    {% endblock %} #}

{% endblock content %}
